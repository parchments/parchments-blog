(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{358:function(e,t,a){"use strict";a.r(t);var s=a(42),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"总结-常见问题解答"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结-常见问题解答"}},[e._v("#")]),e._v(" 总结 & 常见问题解答")]),e._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),a("p",[e._v("在本小册的第一节中，笔者对 Vue.js 内部运行机制做了一个全局的概览，当时通过下面这张图把 Vue.js 拆分成一个一个小模块来介绍，之后通过这一系列小节的学习，相信大家已经对 Vue.js 内部的原理有了一个更进一步的了解，对这张图也再也不会感觉到那么陌生。")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/up-57a7b8d198b8bec402e101746bea72a543a.png",alt:""}})]),e._v(" "),a("p",[e._v("每个小节中的代码都是笔者根据 Vue.js 原理单独抽离出来写成的 Demo，大家可以在我的 "),a("a",{attrs:{href:"https://github.com/answershuto",target:"_blank",rel:"noopener noreferrer"}},[e._v("Gtihub"),a("OutboundLink")],1),e._v(" 上查看完整的代码 (见 "),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo",target:"_blank",rel:"noopener noreferrer"}},[e._v("VueDemo"),a("OutboundLink")],1),e._v(" 项目)。")]),e._v(" "),a("p",[e._v("本小册对 Vue.js 原理进行了初步的介绍，希望能够起到一个抛砖引玉的作用，读者读完以后，可以利用这些基础对 Vue.js 进行一个更加深入的探索，相信会有更大的收获。")]),e._v(" "),a("h2",{attrs:{id:"常见问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[e._v("#")]),e._v(" 常见问题")]),e._v(" "),a("ol",[a("li",[e._v("怎么实现 "),a("code",[e._v("this._test")]),e._v(" 改变而不是 "),a("code",[e._v("this._data.test")]),e._v(" 改变触发更新？")])]),e._v(" "),a("p",[e._v("答：其实这中间有一个"),a("strong",[e._v("代理")]),e._v("的过程。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("_proxy(options.data);\n\nfunction _proxy (data) {\n    const that = this;\n    Object.keys(data).forEach(key => {\n        Object.defineProperty(that, key, {\n            configurable: true,\n            enumerable: true,\n            get: function proxyGetter () {\n                return that._data[key];\n            },\n            set: function proxySetter (val) {\n                that._data[key] = val;\n            }\n        })\n    });\n}\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br")])]),a("p",[e._v("本质就是通过 "),a("code",[e._v("Object.defineProperty")]),e._v(" 使在访问 "),a("code",[e._v("this")]),e._v(" 上的某属性时从 "),a("code",[e._v("this._data")]),e._v(" 中读取（写入）。")]),e._v(" "),a("ol",[a("li",[e._v("能不能将依赖收集中讲到的 "),a("code",[e._v("dep.addSub(Dep.target)")]),e._v(" 改成 "),a("code",[e._v("dep.addSub(new Watcher())")]),e._v("呢？")])]),e._v(" "),a("p",[e._v("为了便于读者理解这部分内容，我将代码做了简化，实际上一个 "),a("code",[e._v("Watcher")]),e._v(" 对象可能会在多个 "),a("code",[e._v("Dep")]),e._v(" 中，并不是每次 "),a("code",[e._v("addSub")]),e._v(" 都是一个新的 "),a("code",[e._v("Watcher")]),e._v(" 对象，需依赖 "),a("code",[e._v("Dep.target")]),e._v(" 进行收集（实际上 "),a("code",[e._v("Dep.target")]),e._v(" 也是通过 "),a("code",[e._v("Watcher")]),e._v(" 对象的 "),a("code",[e._v("get")]),e._v(" 方法调用 "),a("code",[e._v("pushTarget")]),e._v(" 将自身赋值给 "),a("code",[e._v("Dep.target")]),e._v("）。")])])}),[],!1,null,null,null);t.default=n.exports}}]);